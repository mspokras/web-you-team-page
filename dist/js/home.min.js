!function(){"use strict";!function(){function e(e){return"string"==typeof e}function t(t){return e(t)&&t.length>0}function s(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s]}function n(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s]}class r extends Error{constructor(){super("Main scope variable is busy")}}class a extends Error{constructor(e){let{name:t}=e;super("Module Is Not Ready To Use: ".concat(t))}}class o{constructor(){this.__subscribers={}}on(e,t){e in this.__subscribers||(this.__subscribers[e]=[]),this.__subscribers[e].push(t)}off(e,t){e in this.__subscribers&&(this.__subscribers[e]=this.__subscribers[e].filter((e=>e===t)))}emit(e,t){e in this.__subscribers&&this.__subscribers[e].forEach((e=>e(t)))}}const i={__app__:!0,context:{},registered:new Map,ready:new Map,dependencies:{}};class c extends o{constructor(e){super(),s("Construct module > props: ".concat(JSON.stringify(e))," Module: ".concat(JSON.stringify(this),";")),this.state={registered:!1,ready:!1},Object.assign(this,e);const{name:t,entry:n,required:r,cleanup:a}=e}get ready(){return this.state.ready}set ready(e){this.state.ready=e,this.emit("ready",this)}get registered(){return this.state.registered}set registered(e){this.state.registered=e}init(e){if(s("Init module > context: ".concat(e)," Module: ".concat(this,";")),!this.registered)return n("Module is unregistered");this.context=this.entry(e),this.ready=!0}detouch(){if(s("Detouch module;"," Module: ".concat(this,";")),!this.registered)return n("Module is unregistered");this.ready&&(this.ready=!1,this.cleanup()),this.registered=!1}}var d=new class extends o{constructor(){if(super(),void 0!==window.__app__){if(window.__app__.__app__)return window.__app__;throw new r}Object.assign(this,i),window.__app__=this}isReady(t){return e(t)?this.ready.has(t):t.every((e=>this.ready.has(e)))}isRegistered(t){return e(t)?this.registered.has(t):t.every((e=>this.registered.has(e)))}setAsReady(e){this.context[e.name]=e.context,this.ready.set(e.name,e),this.emit("ready",e)}setAsRegistered(e){this.registered.set(e.name,e)}addDependencies(t,s){const n=e=>{e in this.dependencies?this.dependencies[e].add(t):this.dependencies[e]=new Set(t)};return e(s)?n(s):s.forEach((e=>n(e)))}removeDependencies(t,s){const n=e=>{e in this.dependencies&&this.dependencies[e].remove(t)};return e(s)?n(s):s.forEach((e=>n(e)))}hasReferences(e){var t;return null===(t=this.getReferences(e))||void 0===t?void 0:t.size}getReferences(e){return this.dependencies[e]}get(e){return this.registered.get(e)}use(e){if(!this.isReady(e))throw new a(module);return this.context[e]}add(e){if(this.isRegistered(e.name))return n("The module is already registered: ".concat(e.name));e.on("ready",(()=>this.setAsReady(e))),e.required&&this.addDependencies(e.name,e.required),e.on("beforeDetouch",(()=>this.setAsReady(e))),e.registered=!0,this.setAsRegistered(e),!e.required||this.isReady(e.required)?e.init(this.context):this.on("ready",(t=>{let{name:s}=t;isReady(e.required)&&e.init(this.context)}))}detouch(e){var t;let s=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(hasReferences(e)&&!s)return function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];console.error(...t)}("Module can't be detouched. There are references to this module: ".concat(Array.from(this.getReferences(e)).join(", ")));null===(t=get(e))||void 0===t||t.detouch()}};class l extends o{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(),this.prevState={},this.state=e}update(e){this.prevState=this.state,this.state=e(this.state),this.emit("update",{state:this.state,prevState:this.prevState})}}const u={departments:{status:"idle",data:[]},selectedEmployeeIdx:null,selectedDepartmentId:null,employees:{status:"idle",data:[]}};const p="https://team.web-you.pl/",h="".concat(p,"/wp-json/wp/v2"),m="".concat(p,"/wp-json/custom/v1");class f extends Error{constructor(e,t){super(t||"Bad response (not ok)"),this.response=e}}function g(e){if(!e.ok)throw new f(e)}class y{constructor(e){this.duration=e,this.timer=null}unset(){clearInterval(this.timer),this.timer=null}set(e){this.active&&this.unset(),this.counter=this.duration,this.timer=setInterval((()=>{const t=1===this.counter;e&&e(this.counter,t),t?this.unset():this.counter--}),1e3)}get active(){return null!==this.timer}}function _(e,t,s){const n=new y(5),r=$("#".concat(e," [data-msg-disclosure='data-not-sent']")),a=$("#".concat(e," [data-msg-disclosure='data-successfully-sent']")),o=$("#".concat(e," .contact-form__send-btn")),i=$("#".concat(e," .contact-form__call-btn")),c=$("#".concat(e));i.on("click",(e=>{(function(e){let t,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];console.log("reduceIterator");do{t=e.next(),s.push(t.value)}while(!t.done);return s})(new FormData(c.get(0)).values()).some((e=>void 0!==e&&e.length>0))&&r.addClass("open")})),c.validate({ignore:[],highlight:function(e,t,s){$(e).closest(".form-field").addClass(t)},unhighlight:function(e,t,s){$(e).closest(".form-field").removeClass(t)},errorPlacement:function(e,t){e.appendTo(t.closest(".form-input"))},submitHandler:async function(s,d){if(d.preventDefault(),n.active)return!1;n.set(((e,t)=>{t&&(o.removeClass("disabled"),i.removeClass("disabled"))})),o.addClass("disabled"),i.addClass("disabled");const l=new FormData(s);if("cv-request-contact-form"==e){const{selectedEmployeeIdx:e,employees:s}=t.state;e>-1&&s.data.length&&(l.append("employee-id",s.data[e].id),l.append("employee-name",s.data[e].crb_person_name))}!async function(e){const t=await fetch("".concat(m,"/contact-request/"),{method:"POST",body:e});g(t),t.json()}(l),c.get(0).reset(),r.removeClass("open"),a.addClass("open"),setTimeout((()=>{a.removeClass("open")}),5e3)}})}async function v(e){d.use("pageStore");try{const t=await fetch("".concat(h,"/categories?").concat(e),{method:"GET"});return g(t),t.json()}catch(e){console.error("Error while fetching categories",e)}}(()=>{const e=new c({name:"pageStore",entry:()=>new l(u)});d.add(e)})();const b=new c({name:"page",entry:(e,s)=>{const{pageStore:n,events:r}=e;function a(e){try{new Swiper("#team-select-slider",{observer:!0,resizeObserver:!0,slidesPerView:"auto",grabCursor:!0,centeredSlides:!0,breakpoints:{420:{centeredSlides:!1}}}),function(e,t){const s=document.querySelector("#teamates-slider-counter .teamates-slider__current"),n=document.querySelector("#teamates-slider-counter .teamates-slider__total"),r=new Swiper("#teamates-slider",{observer:!0,resizeObserver:!0,slidesPerView:"auto",centeredSlides:!0,grabCursor:!0,loop:!0,effect:"coverflow",parallax:!0,coverflowEffect:{rotate:40,stretch:350,depth:300,modifier:.65,slideShadows:!1},autoplay:{delay:3e3},navigation:{prevEl:"#teamates-slider-prev",nextEl:"#teamates-slider-next"},breakpoints:{1024:{coverflowEffect:{rotate:40,stretch:500,depth:400,modifier:.65,slideShadows:!1}}},on:{afterInit:e=>{!function(e){e.wrapperEl.addEventListener("click",(t=>{let{target:s}=t;if(!s.classList.contains("teamate-card__btn")&&!s.closest(".teamate-card__btn"))return;const n=s.closest(".swiper-slide");e.slideTo(n.getAttribute("data-slide-idx"),300)}))}(e);const t=c(e);l(t),i(t);const[s]=d(t);a(s)},observerUpdate:e=>{const t=c(e);l(t),i(t),setTimeout((()=>{const[e]=d(t);a(e)}),300)},slideChangeTransitionStart:e=>{setTimeout((()=>{const t=c(e),[s,n]=d(t);!function(e,t,s){if(e.length<1||!t)return;t.setAttribute("data-slide-position",0);const n=Math.min(5,Math.ceil((e.length-1)/2)),r=Math.max(0,s-n),a=Math.min(e.length,s+n+1);e.slice(r,s).reverse().forEach(((e,t)=>{e.setAttribute("data-slide-position",-1-t)})),e.slice(s+1,a).forEach(((e,t)=>{e.setAttribute("data-slide-position",1+t)}))}(t,s,n),a(s)}),300)}}});function a(e){if(e){const n=Number(e.getAttribute("data-card-idx"));t=n+1,s.textContent=t,o(n)}var t}function o(t){e.update((e=>({...e,selectedEmployeeIdx:t})))}function i(e){n.textContent=e.length}function c(e){return[...e.wrapperEl.querySelectorAll(".swiper-slide")]}function d(e){const t=e.findIndex((e=>e.classList.contains("swiper-slide-active")));return[e[t],t]}function l(e){e.length<1||e.forEach(((e,t)=>e.setAttribute("data-slide-idx",t)))}t.on("slideToFirstEmployee",(()=>{r.slideTo(0,300),o(0)}))}(n,r),$("#teamates-list-wrapper").on("click",(e=>{let{target:t}=e;const s=$("header"),n=$("#profile");if(!t.classList.contains("teamate-card__btn")&&!t.closest(".teamate-card__btn"))return;const r=n.get(0).getBoundingClientRect(),a=s.outerHeight();window.scrollTo({top:window.scrollY+r.top-a,behavior:"smooth"})})),_("main-contact-form",n),_("cv-request-contact-form",n),function(e,t){const s=$("#profile-main"),n=$("#employee-profile-template").html(),r=$("#profile-skills-rates"),a=$("#employee-skills-rates-template").html(),o=$("#profile-tags-cloud"),i=$("#employee-tags-cloud-template").html();Mustache.parse(n),Mustache.parse(a),Mustache.parse(i),s.on("click",(e=>{let{target:t}=e;(t.classList.contains("profile__download-btn")||t.closest(".profile__download-btn"))&&drawers.open("cv-request-form",t)})),e.on("update",(e=>{let{state:t,prevState:c}=e;if(t.selectedEmployeeIdx===c.selectedEmployeeIdx&&t.employees===c.employees)return;const{status:d,data:l}=t.employees;if(0===l.length)return;const{selectedEmployeeIdx:u}=t,p=l[u];(function(e,t){s.html(Mustache.render(n,t))})(0,p),function(e,t){const s=t.map((e=>{let{crb_name:t,crb_rate:s}=e;return{crb_name:t,crb_rate:new Array(s)}}));r.html(Mustache.render(a,s))}(0,p.crb_skills_list),function(e,t){let{crb_main_message:s,crb_tags_cloud:n}=t;const r=360/n.length,a={crb_main_message:s,crb_tags_cloud:n.map(((e,t)=>({...e,"placing-degree":"".concat(t*r+(.1*-r+.2*r*Math.random()),"deg"),"distance-shift":"".concat(.1*Math.random()-.05)})))};console.log(a),o.html(Mustache.render(i,a))}(0,p)}))}(n),function(e,s){const n=$("#teamates-list-wrapper"),r=$("#employee-card-template").html();Mustache.parse(r),e.on("update",(e=>{let{state:t,prevState:s}=e;if(t.employees===s.employees)return;const{status:n,data:r}=t.employees;i(0,r)})),e.on("update",(e=>{let{state:s,prevState:n}=e;s.selectedDepartmentId!==n.selectedDepartmentId&&async function(e){const s=d.use("pageStore");s.update((e=>({...e,employees:{...e.employees,status:"loading"}})));const n=(await async function(e){d.use("pageStore");try{const t=await fetch("".concat(h,"/employees?per_page=100&").concat(e),{method:"GET"});return g(t),t.json()}catch(e){console.error("Error while fetcheeng employees")}}("categories=".concat(e))).sort(((e,s)=>{const n=e.crb_order,r=s.crb_order;return t(n)&&t(r)?Number(n)-Number(r):t(n)?-1:t(r)?1:0}));n.forEach(((e,t)=>e.__idx=t)),s.update((e=>({...e,employees:{...e.employees,status:"idle",data:n}})))}(s.selectedDepartmentId)}));const{status:a,data:o}=e.state.employees;function i(e,t){n.html(Mustache.render(r,t)),s.emit("slideToFirstEmployee")}i(0,o)}(n,r),async function(e,t){let s=null;const n=$("#department-select-wrapper");function r(t){if(s===t)return;s&&s.classList.remove("active");const n=t.getAttribute("data-id");e.update((e=>({...e,selectedDepartmentId:n}))),t.classList.add("active"),s=t}e.on("update",(e=>{let{state:t,prevState:s}=e;if(t.departments===s.departments)return;const{status:a,data:o}=t.departments;!function(e,t){n.html(function(e,t){return t.map((e=>'<div class="swiper-slide">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class="text-link section-nav__btn" data-slug="'.concat(e.slug,'" data-id="').concat(e.id,'">').concat(e.html_representation,"</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>"))).join("")}(0,t))}(0,o);const i=n.find("[data-id]").first().get(0);i&&r(i)})),async function(){const e=d.use("pageStore"),t={"en-US":"en","pl-PL":"pl"},s=document.documentElement.getAttribute("lang");console.log(s),e.update((e=>({...e,departments:{...e.departments,status:"loading"}}))),console.log(t[s]);const n=await async function(e){d.use("pageStore"),console.log("fetchCategory. slug: ".concat(e));const t="slug=".concat(e);return(await v(t))[0]}("employees-".concat(t[s]));console.log(n);const r=await v("parent=".concat(n.id));e.update((e=>({...e,departments:{...e.departments,status:"idle",data:r}})))}(),n.on("click",(e=>{let{target:t}=e;t.hasAttribute("data-id")&&r(t)}))}(n)}catch(e){!function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s]}(e)}}n.on("update",(e=>{let{state:t,prevState:s}=e;return console.log(t,s)})),"interactive"===document.readyState?a():window.addEventListener("DOMContentLoaded",a)},required:["events","commonStore","pageStore"]});d.add(b)}()}();